% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/biomarker_plots.R
\name{plot_biomarker_risk_continuum}
\alias{plot_biomarker_risk_continuum}
\title{Plot Biomarker Risk Continuum}
\usage{
plot_biomarker_risk_continuum(
  data,
  biomarker_col,
  target_age,
  max_age = 90,
  n_bins = 10,
  adjusted = TRUE,
  title = NULL,
  xlim = NULL,
  log_transform = FALSE,
  xlab = NULL,
  smooth_line = FALSE,
  show_points = TRUE,
  colors = NULL,
  age_labels = NULL
)
}
\arguments{
\item{data}{Input dataset with required columns: ids, entryage, survage, status, astatus}

\item{biomarker_col}{Name of the biomarker column}

\item{target_age}{Age(s) at which to estimate lifetime risk (e.g., 45 or c(45, 55))}

\item{max_age}{Maximum age for follow-up (default: 90)}

\item{n_bins}{Number of biomarker bins to create (default: 10)}

\item{adjusted}{Use competing risk adjusted estimates (default: TRUE)}

\item{title}{Plot title (optional)}

\item{xlim}{Numeric vector of length 2 specifying X-axis limits (optional)}

\item{log_transform}{Logical; apply log10 transformation to X-axis (default: FALSE)}

\item{xlab}{X-axis label (optional, defaults to biomarker column name)}

\item{smooth_line}{Logical; use smoothed line and confidence interval instead of connecting points (default: FALSE)}

\item{show_points}{Logical; show individual data points (default: TRUE)}

\item{colors}{Vector of colors for different target ages (optional, defaults to rainbow colors)}

\item{age_labels}{Named vector for age labels in legend, e.g. c("45"="Age 45", "55"="Age 55") (optional)}
}
\value{
A ggplot object showing biomarker values vs lifetime risk
}
\description{
Creates a plot showing lifetime risk across the continuum of a biomarker at one or more target ages.
}
\details{
This function bins the biomarker into quantiles, runs PIE analysis on each bin for each target age,
and plots the resulting lifetime risk estimates. When multiple target ages are provided, each age
gets its own colored line. X-axis can be customized with limits and log transformation for better
visualization of biomarkers with wide ranges.
When smooth_line=TRUE, replaces the point-to-point line with a LOESS smooth and
replaces the PIE confidence intervals with smooth-based confidence intervals.
}
\examples{
# Add biomarker to test data
test_data$biomarker <- rnorm(nrow(test_data), 100, 20)

# Single target age (original functionality)
plot_biomarker_risk_continuum(test_data, "biomarker", target_age = 50)

# Multiple target ages with different colored lines
plot_biomarker_risk_continuum(test_data, "biomarker", target_age = c(45, 55))

# With custom age labels and colors
plot_biomarker_risk_continuum(test_data, "biomarker", target_age = c(45, 55),
                              age_labels = c("45"="Starting at 45", "55"="Starting at 55"),
                              colors = c("red", "blue"))

# With log transformation and smoothing (good for biomarkers like NTproBNP)
plot_biomarker_risk_continuum(test_data, "ntprobnp", target_age = c(45, 55), 
                              log_transform = TRUE, xlim = c(10, 1000), smooth_line = TRUE)

# Clean smooth line without points
plot_biomarker_risk_continuum(test_data, "ntprobnp", target_age = c(45, 55),
                              smooth_line = TRUE, show_points = FALSE)
}
